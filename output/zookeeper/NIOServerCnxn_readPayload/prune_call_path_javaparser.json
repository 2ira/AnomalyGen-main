{
  "org.apache.zookeeper.server.NIOServerCnxn:readConnectRequest()": "['ENTRY -> IF_TRUE: !isZKServerRunning() -> THROW: new IOException(\"ZooKeeperServer not running\") -> EXIT', 'ENTRY -> IF_FALSE: !isZKServerRunning() -> CALL: zkServer.processConnectRequest -> EXIT']",
  "org.apache.zookeeper.server.NIOServerCnxn:readPayload()": "['ENTRY -> IF_TRUE: incomingBuffer.remaining() != 0 -> IF_TRUE: rc < 0 -> CALL: handleFailedRead -> IF_TRUE: incomingBuffer.remaining() == 0 -> CALL: incomingBuffer.flip -> CALL: packetReceived -> IF_TRUE: !initialized -> CALL: readConnectRequest -> CALL: lenBuffer.clear -> EXIT', 'ENTRY -> IF_TRUE: incomingBuffer.remaining() != 0 -> IF_TRUE: rc < 0 -> CALL: handleFailedRead -> IF_TRUE: incomingBuffer.remaining() == 0 -> CALL: incomingBuffer.flip -> CALL: packetReceived -> IF_FALSE: !initialized -> CALL: readRequest -> CALL: lenBuffer.clear -> EXIT', 'ENTRY -> IF_TRUE: incomingBuffer.remaining() != 0 -> IF_TRUE: rc < 0 -> CALL: handleFailedRead -> IF_FALSE: incomingBuffer.remaining() == 0 -> EXIT', 'ENTRY -> IF_TRUE: incomingBuffer.remaining() != 0 -> IF_FALSE: rc < 0 -> IF_TRUE: incomingBuffer.remaining() == 0 -> CALL: incomingBuffer.flip -> CALL: packetReceived -> IF_TRUE: !initialized -> CALL: readConnectRequest -> CALL: lenBuffer.clear -> EXIT', 'ENTRY -> IF_TRUE: incomingBuffer.remaining() != 0 -> IF_FALSE: rc < 0 -> IF_TRUE: incomingBuffer.remaining() == 0 -> CALL: incomingBuffer.flip -> CALL: packetReceived -> IF_FALSE: !initialized -> CALL: readRequest -> CALL: lenBuffer.clear -> EXIT', 'ENTRY -> IF_TRUE: incomingBuffer.remaining() != 0 -> IF_FALSE: rc < 0 -> IF_FALSE: incomingBuffer.remaining() == 0 -> EXIT', 'ENTRY -> IF_FALSE: incomingBuffer.remaining() != 0 -> IF_TRUE: incomingBuffer.remaining() == 0 -> CALL: incomingBuffer.flip -> CALL: packetReceived -> IF_TRUE: !initialized -> CALL: readConnectRequest -> CALL: lenBuffer.clear -> EXIT', 'ENTRY -> IF_FALSE: incomingBuffer.remaining() != 0 -> IF_TRUE: incomingBuffer.remaining() == 0 -> CALL: incomingBuffer.flip -> CALL: packetReceived -> IF_FALSE: !initialized -> CALL: readRequest -> CALL: lenBuffer.clear -> EXIT', 'ENTRY -> IF_FALSE: incomingBuffer.remaining() != 0 -> IF_FALSE: incomingBuffer.remaining() == 0 -> EXIT']",
  "org.apache.zookeeper.server.NIOServerCnxn:readRequest()": "['ENTRY -> CALL: ByteBufferInputStream.byteBuffer2Record -> CALL: zkServer.processPacket -> EXIT']",
  "org.apache.zookeeper.server.ZooKeeperServer:processConnectRequest(org.apache.zookeeper.server.ServerCnxn,java.nio.ByteBuffer)": "[\"ENTRY -> LOG: LOG.DEBUG: Session establishment request from client {} client's lastZxid is 0x{}, cnxn.getRemoteSocketAddress(), Long.toHexString(request.getLastZxidSeen()) -> IF_TRUE: connThrottle.isConnectionWeightEnabled() -> IF_TRUE: sessionId == 0 -> IF_TRUE: localSessionEnabled -> CALL: getRequiredTokensForLocal -> IF_TRUE: !connThrottle.checkLimit(tokensNeeded) -> THROW: new ClientCnxnLimitException() -> EXIT\", \"ENTRY -> LOG: LOG.DEBUG: Session establishment request from client {} client's lastZxid is 0x{}, cnxn.getRemoteSocketAddress(), Long.toHexString(request.getLastZxidSeen()) -> IF_TRUE: connThrottle.isConnectionWeightEnabled() -> IF_TRUE: sessionId == 0 -> IF_TRUE: localSessionEnabled -> CALL: getRequiredTokensForLocal -> IF_FALSE: !connThrottle.checkLimit(tokensNeeded) -> CALL: ServerMetrics.getMetrics().CONNECTION_TOKEN_DEFICIT.add -> CALL: ServerMetrics.getMetrics().CONNECTION_REQUEST_COUNT.add -> IF_FALSE: !cnxn.protocolManager.isReadonlyAvailable() -> IF_TRUE: !request.getReadOnly() && this instanceof ReadOnlyZooKeeperServer -> LOG: LOG.INFO: msg -> THROW: new CloseRequestException(msg, ServerCnxn.DisconnectReason.NOT_READ_ONLY_CLIENT) -> EXIT\", \"ENTRY -> LOG: LOG.DEBUG: Session establishment request from client {} client's lastZxid is 0x{}, cnxn.getRemoteSocketAddress(), Long.toHexString(request.getLastZxidSeen()) -> IF_TRUE: connThrottle.isConnectionWeightEnabled() -> IF_TRUE: sessionId == 0 -> IF_TRUE: localSessionEnabled -> CALL: getRequiredTokensForLocal -> IF_FALSE: !connThrottle.checkLimit(tokensNeeded) -> CALL: ServerMetrics.getMetrics().CONNECTION_TOKEN_DEFICIT.add -> CALL: ServerMetrics.getMetrics().CONNECTION_REQUEST_COUNT.add -> IF_FALSE: !cnxn.protocolManager.isReadonlyAvailable() -> IF_FALSE: !request.getReadOnly() && this instanceof ReadOnlyZooKeeperServer -> IF_TRUE: request.getLastZxidSeen() > zkDb.dataTree.lastProcessedZxid -> LOG: LOG.INFO: msg -> THROW: new CloseRequestException(msg, ServerCnxn.DisconnectReason.CLIENT_ZXID_AHEAD) -> EXIT\", \"ENTRY -> LOG: LOG.DEBUG: Session establishment request from client {} client's lastZxid is 0x{}, cnxn.getRemoteSocketAddress(), Long.toHexString(request.getLastZxidSeen()) -> IF_TRUE: connThrottle.isConnectionWeightEnabled() -> IF_TRUE: sessionId == 0 -> IF_FALSE: localSessionEnabled -> CALL: getRequiredTokensForGlobal -> IF_TRUE: !connThrottle.checkLimit(tokensNeeded) -> THROW: new ClientCnxnLimitException() -> EXIT\", \"ENTRY -> LOG: LOG.DEBUG: Session establishment request from client {} client's lastZxid is 0x{}, cnxn.getRemoteSocketAddress(), Long.toHexString(request.getLastZxidSeen()) -> IF_TRUE: connThrottle.isConnectionWeightEnabled() -> IF_TRUE: sessionId == 0 -> IF_FALSE: localSessionEnabled -> CALL: getRequiredTokensForGlobal -> IF_FALSE: !connThrottle.checkLimit(tokensNeeded) -> CALL: ServerMetrics.getMetrics().CONNECTION_TOKEN_DEFICIT.add -> CALL: ServerMetrics.getMetrics().CONNECTION_REQUEST_COUNT.add -> IF_FALSE: !cnxn.protocolManager.isReadonlyAvailable() -> IF_TRUE: !request.getReadOnly() && this instanceof ReadOnlyZooKeeperServer -> LOG: LOG.INFO: msg -> THROW: new CloseRequestException(msg, ServerCnxn.DisconnectReason.NOT_READ_ONLY_CLIENT) -> EXIT\", \"ENTRY -> LOG: LOG.DEBUG: Session establishment request from client {} client's lastZxid is 0x{}, cnxn.getRemoteSocketAddress(), Long.toHexString(request.getLastZxidSeen()) -> IF_TRUE: connThrottle.isConnectionWeightEnabled() -> IF_TRUE: sessionId == 0 -> IF_FALSE: localSessionEnabled -> CALL: getRequiredTokensForGlobal -> IF_FALSE: !connThrottle.checkLimit(tokensNeeded) -> CALL: ServerMetrics.getMetrics().CONNECTION_TOKEN_DEFICIT.add -> CALL: ServerMetrics.getMetrics().CONNECTION_REQUEST_COUNT.add -> IF_FALSE: !cnxn.protocolManager.isReadonlyAvailable() -> IF_FALSE: !request.getReadOnly() && this instanceof ReadOnlyZooKeeperServer -> IF_TRUE: request.getLastZxidSeen() > zkDb.dataTree.lastProcessedZxid -> LOG: LOG.INFO: msg -> THROW: new CloseRequestException(msg, ServerCnxn.DisconnectReason.CLIENT_ZXID_AHEAD) -> EXIT\", \"ENTRY -> LOG: LOG.DEBUG: Session establishment request from client {} client's lastZxid is 0x{}, cnxn.getRemoteSocketAddress(), Long.toHexString(request.getLastZxidSeen()) -> IF_TRUE: connThrottle.isConnectionWeightEnabled() -> IF_FALSE: sessionId == 0 -> CALL: getRequiredTokensForRenew -> IF_TRUE: !connThrottle.checkLimit(tokensNeeded) -> THROW: new ClientCnxnLimitException() -> EXIT\", \"ENTRY -> LOG: LOG.DEBUG: Session establishment request from client {} client's lastZxid is 0x{}, cnxn.getRemoteSocketAddress(), Long.toHexString(request.getLastZxidSeen()) -> IF_TRUE: connThrottle.isConnectionWeightEnabled() -> IF_FALSE: sessionId == 0 -> CALL: getRequiredTokensForRenew -> IF_FALSE: !connThrottle.checkLimit(tokensNeeded) -> CALL: ServerMetrics.getMetrics().CONNECTION_TOKEN_DEFICIT.add -> CALL: ServerMetrics.getMetrics().CONNECTION_REQUEST_COUNT.add -> IF_TRUE: !cnxn.protocolManager.isReadonlyAvailable() -> LOG: LOG.WARN: Connection request from old client {}; will be dropped if server is in r-o mode, cnxn.getRemoteSocketAddress() -> IF_TRUE: !request.getReadOnly() && this instanceof ReadOnlyZooKeeperServer -> LOG: LOG.INFO: msg -> THROW: new CloseRequestException(msg, ServerCnxn.DisconnectReason.NOT_READ_ONLY_CLIENT) -> EXIT\", \"ENTRY -> LOG: LOG.DEBUG: Session establishment request from client {} client's lastZxid is 0x{}, cnxn.getRemoteSocketAddress(), Long.toHexString(request.getLastZxidSeen()) -> IF_TRUE: connThrottle.isConnectionWeightEnabled() -> IF_FALSE: sessionId == 0 -> CALL: getRequiredTokensForRenew -> IF_FALSE: !connThrottle.checkLimit(tokensNeeded) -> CALL: ServerMetrics.getMetrics().CONNECTION_TOKEN_DEFICIT.add -> CALL: ServerMetrics.getMetrics().CONNECTION_REQUEST_COUNT.add -> IF_FALSE: !cnxn.protocolManager.isReadonlyAvailable() -> IF_TRUE: !request.getReadOnly() && this instanceof ReadOnlyZooKeeperServer -> LOG: LOG.INFO: msg -> THROW: new CloseRequestException(msg, ServerCnxn.DisconnectReason.NOT_READ_ONLY_CLIENT) -> EXIT\", \"ENTRY -> LOG: LOG.DEBUG: Session establishment request from client {} client's lastZxid is 0x{}, cnxn.getRemoteSocketAddress(), Long.toHexString(request.getLastZxidSeen()) -> IF_TRUE: connThrottle.isConnectionWeightEnabled() -> IF_FALSE: sessionId == 0 -> CALL: getRequiredTokensForRenew -> IF_FALSE: !connThrottle.checkLimit(tokensNeeded) -> CALL: ServerMetrics.getMetrics().CONNECTION_TOKEN_DEFICIT.add -> CALL: ServerMetrics.getMetrics().CONNECTION_REQUEST_COUNT.add -> IF_FALSE: !cnxn.protocolManager.isReadonlyAvailable() -> IF_FALSE: !request.getReadOnly() && this instanceof ReadOnlyZooKeeperServer -> IF_TRUE: request.getLastZxidSeen() > zkDb.dataTree.lastProcessedZxid -> LOG: LOG.INFO: msg -> THROW: new CloseRequestException(msg, ServerCnxn.DisconnectReason.CLIENT_ZXID_AHEAD) -> EXIT\", \"ENTRY -> LOG: LOG.DEBUG: Session establishment request from client {} client's lastZxid is 0x{}, cnxn.getRemoteSocketAddress(), Long.toHexString(request.getLastZxidSeen()) -> IF_FALSE: connThrottle.isConnectionWeightEnabled() -> IF_TRUE: !connThrottle.checkLimit(tokensNeeded) -> THROW: new ClientCnxnLimitException() -> EXIT\", \"ENTRY -> LOG: LOG.DEBUG: Session establishment request from client {} client's lastZxid is 0x{}, cnxn.getRemoteSocketAddress(), Long.toHexString(request.getLastZxidSeen()) -> IF_FALSE: connThrottle.isConnectionWeightEnabled() -> IF_FALSE: !connThrottle.checkLimit(tokensNeeded) -> CALL: ServerMetrics.getMetrics().CONNECTION_TOKEN_DEFICIT.add -> CALL: ServerMetrics.getMetrics().CONNECTION_REQUEST_COUNT.add -> IF_TRUE: !cnxn.protocolManager.isReadonlyAvailable() -> LOG: LOG.WARN: Connection request from old client {}; will be dropped if server is in r-o mode, cnxn.getRemoteSocketAddress() -> IF_TRUE: !request.getReadOnly() && this instanceof ReadOnlyZooKeeperServer -> LOG: LOG.INFO: msg -> THROW: new CloseRequestException(msg, ServerCnxn.DisconnectReason.NOT_READ_ONLY_CLIENT) -> EXIT\", \"ENTRY -> LOG: LOG.DEBUG: Session establishment request from client {} client's lastZxid is 0x{}, cnxn.getRemoteSocketAddress(), Long.toHexString(request.getLastZxidSeen()) -> IF_FALSE: connThrottle.isConnectionWeightEnabled() -> IF_FALSE: !connThrottle.checkLimit(tokensNeeded) -> CALL: ServerMetrics.getMetrics().CONNECTION_TOKEN_DEFICIT.add -> CALL: ServerMetrics.getMetrics().CONNECTION_REQUEST_COUNT.add -> IF_TRUE: !cnxn.protocolManager.isReadonlyAvailable() -> LOG: LOG.WARN: Connection request from old client {}; will be dropped if server is in r-o mode, cnxn.getRemoteSocketAddress() -> IF_FALSE: !request.getReadOnly() && this instanceof ReadOnlyZooKeeperServer -> IF_TRUE: request.getLastZxidSeen() > zkDb.dataTree.lastProcessedZxid -> LOG: LOG.INFO: msg -> THROW: new CloseRequestException(msg, ServerCnxn.DisconnectReason.CLIENT_ZXID_AHEAD) -> EXIT\", \"ENTRY -> LOG: LOG.DEBUG: Session establishment request from client {} client's lastZxid is 0x{}, cnxn.getRemoteSocketAddress(), Long.toHexString(request.getLastZxidSeen()) -> IF_FALSE: connThrottle.isConnectionWeightEnabled() -> IF_FALSE: !connThrottle.checkLimit(tokensNeeded) -> CALL: ServerMetrics.getMetrics().CONNECTION_TOKEN_DEFICIT.add -> CALL: ServerMetrics.getMetrics().CONNECTION_REQUEST_COUNT.add -> IF_FALSE: !cnxn.protocolManager.isReadonlyAvailable() -> IF_TRUE: !request.getReadOnly() && this instanceof ReadOnlyZooKeeperServer -> LOG: LOG.INFO: msg -> THROW: new CloseRequestException(msg, ServerCnxn.DisconnectReason.NOT_READ_ONLY_CLIENT) -> EXIT\", \"ENTRY -> LOG: LOG.DEBUG: Session establishment request from client {} client's lastZxid is 0x{}, cnxn.getRemoteSocketAddress(), Long.toHexString(request.getLastZxidSeen()) -> IF_FALSE: connThrottle.isConnectionWeightEnabled() -> IF_FALSE: !connThrottle.checkLimit(tokensNeeded) -> CALL: ServerMetrics.getMetrics().CONNECTION_TOKEN_DEFICIT.add -> CALL: ServerMetrics.getMetrics().CONNECTION_REQUEST_COUNT.add -> IF_FALSE: !cnxn.protocolManager.isReadonlyAvailable() -> IF_FALSE: !request.getReadOnly() && this instanceof ReadOnlyZooKeeperServer -> IF_TRUE: request.getLastZxidSeen() > zkDb.dataTree.lastProcessedZxid -> LOG: LOG.INFO: msg -> THROW: new CloseRequestException(msg, ServerCnxn.DisconnectReason.CLIENT_ZXID_AHEAD) -> EXIT\"]",
  "org.apache.zookeeper.server.ZooKeeperServer:processPacket(org.apache.zookeeper.server.ServerCnxn,java.nio.ByteBuffer)": "['ENTRY -> CALL: incrOutstandingAndCheckThrottle -> IF_TRUE: h.getType() == OpCode.auth -> LOG: LOG.INFO: got auth packet {}, cnxn.getRemoteSocketAddress() -> IF_TRUE: ap != null -> TRY -> CALL: handleAuthentication -> NEW: ServerAuthenticationProvider.ServerObjs -> CALL: getAuth -> NEW: ServerAuthenticationProvider.ServerObjs -> CALL: getAuth -> IF_TRUE: authReturn == KeeperException.Code.OK -> LOG: LOG.INFO: Session 0x{}: auth success for scheme {} and address {}, Long.toHexString(cnxn.getSessionId()), scheme, cnxn.getRemoteSocketAddress() -> CALL: sendResponse -> RETURN -> EXIT', 'ENTRY -> CALL: incrOutstandingAndCheckThrottle -> IF_TRUE: h.getType() == OpCode.auth -> LOG: LOG.INFO: got auth packet {}, cnxn.getRemoteSocketAddress() -> IF_FALSE: ap != null -> IF_TRUE: authReturn == KeeperException.Code.OK -> LOG: LOG.INFO: Session 0x{}: auth success for scheme {} and address {}, Long.toHexString(cnxn.getSessionId()), scheme, cnxn.getRemoteSocketAddress() -> CALL: sendResponse -> RETURN -> EXIT', 'ENTRY -> CALL: incrOutstandingAndCheckThrottle -> IF_TRUE: h.getType() == OpCode.auth -> LOG: LOG.INFO: got auth packet {}, cnxn.getRemoteSocketAddress() -> IF_FALSE: ap != null -> IF_FALSE: authReturn == KeeperException.Code.OK -> IF_TRUE: ap == null -> LOG: LOG.WARN: No authentication provider for scheme: {} has {}, scheme, ProviderRegistry.listProviders() -> CALL: sendResponse -> CALL: sendBuffer -> CALL: disableRecv -> RETURN -> EXIT', 'ENTRY -> CALL: incrOutstandingAndCheckThrottle -> IF_TRUE: h.getType() == OpCode.auth -> LOG: LOG.INFO: got auth packet {}, cnxn.getRemoteSocketAddress() -> IF_FALSE: ap != null -> IF_FALSE: authReturn == KeeperException.Code.OK -> IF_FALSE: ap == null -> LOG: LOG.WARN: Authentication failed for scheme: {}, scheme -> CALL: sendResponse -> CALL: sendBuffer -> CALL: disableRecv -> RETURN -> EXIT', 'ENTRY -> CALL: incrOutstandingAndCheckThrottle -> IF_FALSE: h.getType() == OpCode.auth -> IF_TRUE: h.getType() == OpCode.sasl -> CALL: processSasl -> EXIT', 'ENTRY -> CALL: incrOutstandingAndCheckThrottle -> IF_FALSE: h.getType() == OpCode.auth -> IF_FALSE: h.getType() == OpCode.sasl -> IF_TRUE: !authHelper.enforceAuthentication(cnxn, h.getXid()) -> RETURN -> EXIT', 'ENTRY -> CALL: incrOutstandingAndCheckThrottle -> IF_FALSE: h.getType() == OpCode.auth -> IF_FALSE: h.getType() == OpCode.sasl -> IF_FALSE: !authHelper.enforceAuthentication(cnxn, h.getXid()) -> IF_TRUE: isLargeRequest(length) -> CALL: checkRequestSizeWhenMessageReceived -> CALL: setLargeRequestSize -> CALL: setOwner -> CALL: submitRequest -> EXIT', 'ENTRY -> CALL: incrOutstandingAndCheckThrottle -> IF_FALSE: h.getType() == OpCode.auth -> IF_FALSE: h.getType() == OpCode.sasl -> IF_FALSE: !authHelper.enforceAuthentication(cnxn, h.getXid()) -> IF_FALSE: isLargeRequest(length) -> CALL: setOwner -> CALL: submitRequest -> EXIT']",
  "org.apache.zookeeper.server.ServerCnxn:getAuthInfo()": "['ENTRY -> CALL: unmodifiableList -> NEW: ArrayList<> -> NEW: ArrayList<> -> RETURN -> EXIT']"
}