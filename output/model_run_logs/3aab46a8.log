2025-03-15 03:01:36,842 P273113 INFO {
    "model_name": "Transformer",
    "hidden_size": 128,
    "num_layers": 2,
    "embedding_dim": 32,
    "nhead": 2,
    "dataset": "HDFS",
    "data_dir": "../data/processed/HDFS/no_hdfs_0.0_tar",
    "window_size": 10,
    "stride": 1,
    "feature_type": "sequentials",
    "use_attention": false,
    "label_type": "next_log",
    "use_tfidf": false,
    "max_token_len": 50,
    "min_token_count": 1,
    "epoches": 100,
    "batch_size": 1024,
    "learning_rate": 0.01,
    "topk": 10,
    "patience": 10,
    "random_seed": 42,
    "gpu": 0,
    "hash_id": "3aab46a8"
}
2025-03-15 03:01:51,756 P273113 INFO Load from ../data/processed/HDFS/no_hdfs_0.0_tar
2025-03-15 03:01:51,826 P273113 INFO {
    "label_file": "../data/HDFS/Full/anomaly_label.csv",
    "log_file": "../data/HDFS/Full/HDFS_log_structured.csv",
    "random_sessions": true,
    "test_ratio": 0.2,
    "train_anomaly_ratio": 0.0
}
2025-03-15 03:01:51,836 P273113 INFO # train sessions 446663 (0.00 anomalies)
2025-03-15 03:01:51,837 P273113 INFO # test sessions 115012 (0.03 anomalies)
2025-03-15 03:01:51,842 P273113 INFO Cannot load cached feature extractor.
2025-03-15 03:01:53,144 P273113 INFO 19 tempaltes are found.
2025-03-15 03:01:53,165 P273113 INFO Transforming train data.
2025-03-15 03:02:25,117 P273113 INFO 4692929 sliding windows generated.
2025-03-15 03:02:52,347 P273113 INFO Finish feature extraction (train).
2025-03-15 03:02:52,348 P273113 INFO Transforming test data.
2025-03-15 03:02:52,563 P273113 INFO 10 new templates show while testing.
2025-03-15 03:02:55,865 P273113 INFO 1206665 sliding windows generated.
2025-03-15 03:03:04,893 P273113 INFO Finish feature extraction (test).
2025-03-15 03:03:17,365 P273113 INFO Start training on 4583 batches with cuda:0.
2025-03-15 03:06:02,242 P273113 INFO Epoch 1/100, training loss: 0.27013 [164.88s]
2025-03-15 03:06:02,243 P273113 INFO Evaluating test data.
2025-03-15 03:06:43,448 P273113 INFO Finish inference. [41.21s]
2025-03-15 03:07:43,445 P273113 INFO Calculating acc sum.
2025-03-15 03:07:45,843 P273113 INFO Finish generating store_df.
2025-03-15 03:07:49,126 P273113 INFO {'f1': '0.140', 'rc': '1.000', 'pc': '0.075', 'top1-acc': '0.970'}
2025-03-15 03:07:50,141 P273113 INFO {'f1': '0.201', 'rc': '0.999', 'pc': '0.112', 'top2-acc': '0.970'}
2025-03-15 03:07:51,043 P273113 INFO {'f1': '0.359', 'rc': '0.944', 'pc': '0.222', 'top3-acc': '0.970'}
2025-03-15 03:07:51,845 P273113 INFO {'f1': '0.748', 'rc': '0.929', 'pc': '0.627', 'top4-acc': '0.970'}
2025-03-15 03:07:52,438 P273113 INFO {'f1': '0.784', 'rc': '0.778', 'pc': '0.790', 'top5-acc': '0.970'}
2025-03-15 03:07:53,138 P273113 INFO {'f1': '0.747', 'rc': '0.708', 'pc': '0.792', 'top6-acc': '0.970'}
2025-03-15 03:07:53,730 P273113 INFO {'f1': '0.562', 'rc': '0.434', 'pc': '0.798', 'top7-acc': '0.970'}
2025-03-15 03:07:54,428 P273113 INFO {'f1': '0.573', 'rc': '0.431', 'pc': '0.856', 'top8-acc': '0.970'}
2025-03-15 03:07:54,923 P273113 INFO {'f1': '0.493', 'rc': '0.350', 'pc': '0.835', 'top9-acc': '0.970'}
2025-03-15 03:07:55,329 P273113 INFO {'f1': '0.498', 'rc': '0.350', 'pc': '0.867', 'top10-acc': '0.970'}
2025-03-15 03:07:55,330 P273113 INFO Finish counting [63.99s]
2025-03-15 03:07:58,224 P273113 INFO Saving model to ./experiment_records/3aab46a8/model.ckpt
2025-03-15 03:11:31,240 P273113 INFO Epoch 2/100, training loss: 0.25158 [213.00s]
2025-03-15 03:11:31,241 P273113 INFO Evaluating test data.
2025-03-15 03:12:22,650 P273113 INFO Finish inference. [51.41s]
2025-03-15 03:12:33,945 P273113 INFO Calculating acc sum.
2025-03-15 03:12:35,154 P273113 INFO Finish generating store_df.
2025-03-15 03:12:36,745 P273113 INFO {'f1': '0.165', 'rc': '1.000', 'pc': '0.090', 'top1-acc': '0.970'}
2025-03-15 03:12:37,154 P273113 INFO {'f1': '0.177', 'rc': '0.850', 'pc': '0.099', 'top2-acc': '0.970'}
2025-03-15 03:12:37,550 P273113 INFO {'f1': '0.315', 'rc': '0.752', 'pc': '0.199', 'top3-acc': '0.970'}
2025-03-15 03:12:37,930 P273113 INFO {'f1': '0.776', 'rc': '0.730', 'pc': '0.828', 'top4-acc': '0.970'}
2025-03-15 03:12:38,254 P273113 INFO {'f1': '0.809', 'rc': '0.729', 'pc': '0.908', 'top5-acc': '0.970'}
2025-03-15 03:12:38,667 P273113 INFO {'f1': '0.816', 'rc': '0.729', 'pc': '0.926', 'top6-acc': '0.970'}
2025-03-15 03:12:39,042 P273113 INFO {'f1': '0.820', 'rc': '0.728', 'pc': '0.937', 'top7-acc': '0.970'}
2025-03-15 03:12:39,450 P273113 INFO {'f1': '0.767', 'rc': '0.645', 'pc': '0.947', 'top8-acc': '0.970'}
2025-03-15 03:12:39,854 P273113 INFO {'f1': '0.743', 'rc': '0.600', 'pc': '0.976', 'top9-acc': '0.970'}
2025-03-15 03:12:40,239 P273113 INFO {'f1': '0.667', 'rc': '0.508', 'pc': '0.974', 'top10-acc': '0.970'}
2025-03-15 03:12:40,239 P273113 INFO Finish counting [16.14s]
2025-03-15 03:12:42,736 P273113 INFO Saving model to ./experiment_records/3aab46a8/model.ckpt
2025-03-15 03:16:03,253 P273113 INFO Epoch 3/100, training loss: 0.23404 [200.50s]
2025-03-15 03:16:03,254 P273113 INFO Evaluating test data.
2025-03-15 03:16:38,664 P273113 INFO Finish inference. [35.41s]
2025-03-15 03:17:13,635 P273113 INFO Calculating acc sum.
2025-03-15 03:17:14,758 P273113 INFO Finish generating store_df.
2025-03-15 03:17:16,334 P273113 INFO {'f1': '0.165', 'rc': '1.000', 'pc': '0.090', 'top1-acc': '0.970'}
2025-03-15 03:17:16,828 P273113 INFO {'f1': '0.201', 'rc': '0.841', 'pc': '0.114', 'top2-acc': '0.970'}
2025-03-15 03:17:17,252 P273113 INFO {'f1': '0.304', 'rc': '0.756', 'pc': '0.190', 'top3-acc': '0.970'}
2025-03-15 03:17:17,657 P273113 INFO {'f1': '0.771', 'rc': '0.736', 'pc': '0.809', 'top4-acc': '0.970'}
2025-03-15 03:17:17,935 P273113 INFO {'f1': '0.802', 'rc': '0.733', 'pc': '0.885', 'top5-acc': '0.970'}
2025-03-15 03:17:18,248 P273113 INFO {'f1': '0.810', 'rc': '0.731', 'pc': '0.909', 'top6-acc': '0.970'}
2025-03-15 03:17:18,542 P273113 INFO {'f1': '0.814', 'rc': '0.726', 'pc': '0.927', 'top7-acc': '0.970'}
2025-03-15 03:17:18,766 P273113 INFO {'f1': '0.792', 'rc': '0.685', 'pc': '0.937', 'top8-acc': '0.970'}
2025-03-15 03:17:19,147 P273113 INFO {'f1': '0.716', 'rc': '0.576', 'pc': '0.944', 'top9-acc': '0.970'}
2025-03-15 03:17:19,430 P273113 INFO {'f1': '0.642', 'rc': '0.487', 'pc': '0.944', 'top10-acc': '0.970'}
2025-03-15 03:17:19,431 P273113 INFO Finish counting [36.77s]
2025-03-15 03:20:54,314 P273113 INFO Epoch 4/100, training loss: 0.22696 [212.56s]
2025-03-15 03:20:54,315 P273113 INFO Evaluating test data.
2025-03-15 03:21:17,442 P273113 INFO Finish inference. [23.13s]
2025-03-15 03:21:25,274 P273113 INFO Calculating acc sum.
2025-03-15 03:21:25,603 P273113 INFO Finish generating store_df.
2025-03-15 03:21:26,096 P273113 INFO {'f1': '0.166', 'rc': '1.000', 'pc': '0.091', 'top1-acc': '0.970'}
2025-03-15 03:21:26,214 P273113 INFO {'f1': '0.202', 'rc': '0.916', 'pc': '0.113', 'top2-acc': '0.970'}
2025-03-15 03:21:26,328 P273113 INFO {'f1': '0.371', 'rc': '0.903', 'pc': '0.233', 'top3-acc': '0.970'}
2025-03-15 03:21:26,436 P273113 INFO {'f1': '0.782', 'rc': '0.735', 'pc': '0.835', 'top4-acc': '0.970'}
2025-03-15 03:21:26,541 P273113 INFO {'f1': '0.805', 'rc': '0.731', 'pc': '0.895', 'top5-acc': '0.970'}
2025-03-15 03:21:26,647 P273113 INFO {'f1': '0.823', 'rc': '0.730', 'pc': '0.942', 'top6-acc': '0.970'}
2025-03-15 03:21:26,755 P273113 INFO {'f1': '0.826', 'rc': '0.721', 'pc': '0.966', 'top7-acc': '0.970'}
2025-03-15 03:21:26,854 P273113 INFO {'f1': '0.798', 'rc': '0.677', 'pc': '0.972', 'top8-acc': '0.970'}
2025-03-15 03:21:26,955 P273113 INFO {'f1': '0.732', 'rc': '0.588', 'pc': '0.969', 'top9-acc': '0.970'}
2025-03-15 03:21:27,057 P273113 INFO {'f1': '0.691', 'rc': '0.536', 'pc': '0.972', 'top10-acc': '0.970'}
2025-03-15 03:21:27,057 P273113 INFO Finish counting [8.19s]
2025-03-15 03:21:27,804 P273113 INFO Saving model to ./experiment_records/3aab46a8/model.ckpt
2025-03-15 03:24:14,370 P273113 INFO Epoch 5/100, training loss: 0.22905 [166.56s]
2025-03-15 03:24:14,437 P273113 INFO Evaluating test data.
2025-03-15 03:24:42,176 P273113 INFO Finish inference. [27.74s]
2025-03-15 03:24:49,662 P273113 INFO Calculating acc sum.
2025-03-15 03:24:50,001 P273113 INFO Finish generating store_df.
2025-03-15 03:24:50,778 P273113 INFO {'f1': '0.166', 'rc': '1.000', 'pc': '0.090', 'top1-acc': '0.970'}
2025-03-15 03:24:50,901 P273113 INFO {'f1': '0.198', 'rc': '0.833', 'pc': '0.113', 'top2-acc': '0.970'}
2025-03-15 03:24:51,017 P273113 INFO {'f1': '0.312', 'rc': '0.754', 'pc': '0.196', 'top3-acc': '0.970'}
2025-03-15 03:24:51,120 P273113 INFO {'f1': '0.739', 'rc': '0.735', 'pc': '0.743', 'top4-acc': '0.970'}
2025-03-15 03:24:51,238 P273113 INFO {'f1': '0.768', 'rc': '0.735', 'pc': '0.804', 'top5-acc': '0.970'}
2025-03-15 03:24:51,350 P273113 INFO {'f1': '0.818', 'rc': '0.734', 'pc': '0.924', 'top6-acc': '0.970'}
2025-03-15 03:24:51,446 P273113 INFO {'f1': '0.743', 'rc': '0.622', 'pc': '0.920', 'top7-acc': '0.970'}
2025-03-15 03:24:51,581 P273113 INFO {'f1': '0.704', 'rc': '0.564', 'pc': '0.939', 'top8-acc': '0.970'}
2025-03-15 03:24:51,698 P273113 INFO {'f1': '0.679', 'rc': '0.531', 'pc': '0.941', 'top9-acc': '0.970'}
2025-03-15 03:24:51,802 P273113 INFO {'f1': '0.665', 'rc': '0.509', 'pc': '0.961', 'top10-acc': '0.970'}
2025-03-15 03:24:51,802 P273113 INFO Finish counting [8.30s]
2025-03-15 03:27:27,099 P273113 INFO Epoch 6/100, training loss: 0.22371 [154.42s]
2025-03-15 03:27:27,100 P273113 INFO Evaluating test data.
2025-03-15 03:27:46,964 P273113 INFO Finish inference. [19.86s]
2025-03-15 03:27:54,362 P273113 INFO Calculating acc sum.
2025-03-15 03:27:54,649 P273113 INFO Finish generating store_df.
2025-03-15 03:27:55,089 P273113 INFO {'f1': '0.166', 'rc': '1.000', 'pc': '0.091', 'top1-acc': '0.970'}
2025-03-15 03:27:55,197 P273113 INFO {'f1': '0.220', 'rc': '0.923', 'pc': '0.125', 'top2-acc': '0.970'}
2025-03-15 03:27:55,298 P273113 INFO {'f1': '0.349', 'rc': '0.848', 'pc': '0.219', 'top3-acc': '0.970'}
2025-03-15 03:27:55,393 P273113 INFO {'f1': '0.852', 'rc': '0.839', 'pc': '0.865', 'top4-acc': '0.970'}
2025-03-15 03:27:55,492 P273113 INFO {'f1': '0.837', 'rc': '0.755', 'pc': '0.939', 'top5-acc': '0.970'}
2025-03-15 03:27:55,587 P273113 INFO {'f1': '0.833', 'rc': '0.729', 'pc': '0.970', 'top6-acc': '0.970'}
2025-03-15 03:27:55,686 P273113 INFO {'f1': '0.828', 'rc': '0.717', 'pc': '0.980', 'top7-acc': '0.970'}
2025-03-15 03:27:55,782 P273113 INFO {'f1': '0.797', 'rc': '0.670', 'pc': '0.983', 'top8-acc': '0.970'}
2025-03-15 03:27:55,876 P273113 INFO {'f1': '0.737', 'rc': '0.588', 'pc': '0.986', 'top9-acc': '0.970'}
2025-03-15 03:27:55,976 P273113 INFO {'f1': '0.714', 'rc': '0.559', 'pc': '0.987', 'top10-acc': '0.970'}
2025-03-15 03:27:55,976 P273113 INFO Finish counting [7.60s]
2025-03-15 03:27:56,716 P273113 INFO Saving model to ./experiment_records/3aab46a8/model.ckpt
2025-03-15 03:29:22,485 P273113 INFO Epoch 7/100, training loss: 0.24777 [85.76s]
2025-03-15 03:29:22,486 P273113 INFO Evaluating test data.
2025-03-15 03:29:42,641 P273113 INFO Finish inference. [20.15s]
2025-03-15 03:29:50,062 P273113 INFO Calculating acc sum.
2025-03-15 03:29:50,376 P273113 INFO Finish generating store_df.
2025-03-15 03:29:50,855 P273113 INFO {'f1': '0.165', 'rc': '1.000', 'pc': '0.090', 'top1-acc': '0.970'}
2025-03-15 03:29:50,973 P273113 INFO {'f1': '0.168', 'rc': '0.928', 'pc': '0.092', 'top2-acc': '0.970'}
2025-03-15 03:29:51,089 P273113 INFO {'f1': '0.212', 'rc': '0.921', 'pc': '0.120', 'top3-acc': '0.970'}
2025-03-15 03:29:51,192 P273113 INFO {'f1': '0.638', 'rc': '0.908', 'pc': '0.492', 'top4-acc': '0.970'}
2025-03-15 03:29:51,296 P273113 INFO {'f1': '0.812', 'rc': '0.856', 'pc': '0.773', 'top5-acc': '0.970'}
2025-03-15 03:29:51,396 P273113 INFO {'f1': '0.851', 'rc': '0.839', 'pc': '0.862', 'top6-acc': '0.970'}
2025-03-15 03:29:51,497 P273113 INFO {'f1': '0.837', 'rc': '0.785', 'pc': '0.895', 'top7-acc': '0.970'}
2025-03-15 03:29:51,596 P273113 INFO {'f1': '0.841', 'rc': '0.778', 'pc': '0.915', 'top8-acc': '0.970'}
2025-03-15 03:29:51,700 P273113 INFO {'f1': '0.773', 'rc': '0.661', 'pc': '0.929', 'top9-acc': '0.970'}
2025-03-15 03:29:51,801 P273113 INFO {'f1': '0.764', 'rc': '0.647', 'pc': '0.932', 'top10-acc': '0.970'}
2025-03-15 03:29:51,801 P273113 INFO Finish counting [7.90s]
2025-03-15 03:31:21,105 P273113 INFO Epoch 8/100, training loss: 0.21883 [88.65s]
2025-03-15 03:31:21,105 P273113 INFO Evaluating test data.
2025-03-15 03:31:41,352 P273113 INFO Finish inference. [20.25s]
2025-03-15 03:31:48,579 P273113 INFO Calculating acc sum.
2025-03-15 03:31:48,898 P273113 INFO Finish generating store_df.
2025-03-15 03:31:49,411 P273113 INFO {'f1': '0.165', 'rc': '1.000', 'pc': '0.090', 'top1-acc': '0.970'}
2025-03-15 03:31:49,568 P273113 INFO {'f1': '0.191', 'rc': '0.778', 'pc': '0.109', 'top2-acc': '0.970'}
2025-03-15 03:31:49,676 P273113 INFO {'f1': '0.312', 'rc': '0.754', 'pc': '0.197', 'top3-acc': '0.970'}
2025-03-15 03:31:49,777 P273113 INFO {'f1': '0.782', 'rc': '0.733', 'pc': '0.839', 'top4-acc': '0.970'}
2025-03-15 03:31:49,874 P273113 INFO {'f1': '0.810', 'rc': '0.730', 'pc': '0.908', 'top5-acc': '0.970'}
2025-03-15 03:31:49,973 P273113 INFO {'f1': '0.820', 'rc': '0.728', 'pc': '0.940', 'top6-acc': '0.970'}
2025-03-15 03:31:50,078 P273113 INFO {'f1': '0.812', 'rc': '0.702', 'pc': '0.962', 'top7-acc': '0.970'}
2025-03-15 03:31:50,170 P273113 INFO {'f1': '0.782', 'rc': '0.655', 'pc': '0.969', 'top8-acc': '0.970'}
2025-03-15 03:31:50,271 P273113 INFO {'f1': '0.769', 'rc': '0.630', 'pc': '0.986', 'top9-acc': '0.970'}
2025-03-15 03:31:50,368 P273113 INFO {'f1': '0.756', 'rc': '0.611', 'pc': '0.991', 'top10-acc': '0.970'}
2025-03-15 03:31:50,368 P273113 INFO Finish counting [7.75s]
2025-03-15 03:33:15,495 P273113 INFO Epoch 9/100, training loss: 0.22665 [84.39s]
2025-03-15 03:33:15,496 P273113 INFO Evaluating test data.
2025-03-15 03:33:36,250 P273113 INFO Finish inference. [20.75s]
2025-03-15 03:33:43,652 P273113 INFO Calculating acc sum.
2025-03-15 03:33:44,015 P273113 INFO Finish generating store_df.
2025-03-15 03:33:44,502 P273113 INFO {'f1': '0.165', 'rc': '1.000', 'pc': '0.090', 'top1-acc': '0.970'}
2025-03-15 03:33:44,614 P273113 INFO {'f1': '0.202', 'rc': '0.833', 'pc': '0.115', 'top2-acc': '0.970'}
2025-03-15 03:33:44,717 P273113 INFO {'f1': '0.318', 'rc': '0.755', 'pc': '0.201', 'top3-acc': '0.970'}
2025-03-15 03:33:44,839 P273113 INFO {'f1': '0.771', 'rc': '0.734', 'pc': '0.812', 'top4-acc': '0.970'}
2025-03-15 03:33:44,941 P273113 INFO {'f1': '0.805', 'rc': '0.734', 'pc': '0.892', 'top5-acc': '0.970'}
2025-03-15 03:33:45,037 P273113 INFO {'f1': '0.815', 'rc': '0.730', 'pc': '0.921', 'top6-acc': '0.970'}
2025-03-15 03:33:45,151 P273113 INFO {'f1': '0.818', 'rc': '0.710', 'pc': '0.965', 'top7-acc': '0.970'}
2025-03-15 03:33:45,253 P273113 INFO {'f1': '0.816', 'rc': '0.705', 'pc': '0.970', 'top8-acc': '0.970'}
2025-03-15 03:33:45,353 P273113 INFO {'f1': '0.799', 'rc': '0.675', 'pc': '0.979', 'top9-acc': '0.970'}
2025-03-15 03:33:45,453 P273113 INFO {'f1': '0.695', 'rc': '0.538', 'pc': '0.982', 'top10-acc': '0.970'}
2025-03-15 03:33:45,453 P273113 INFO Finish counting [7.82s]
2025-03-15 03:33:46,135 P273113 INFO Early stop at epoch: 9
2025-03-15 03:33:46,135 P273113 INFO Loading model from ./experiment_records/3aab46a8/model.ckpt
