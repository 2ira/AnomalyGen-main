2025-03-15 02:58:48,451 P272409 INFO {
    "model_name": "LSTM",
    "use_attention": false,
    "hidden_size": 128,
    "num_layers": 2,
    "num_directions": 2,
    "embedding_dim": 32,
    "dataset": "HDFS",
    "data_dir": "../data/processed/HDFS/hdfs_0.0_tar",
    "window_size": 10,
    "stride": 1,
    "feature_type": "sequentials",
    "label_type": "next_log",
    "use_tfidf": false,
    "max_token_len": 50,
    "min_token_count": 1,
    "epoches": 100,
    "batch_size": 1024,
    "learning_rate": 0.01,
    "topk": 10,
    "patience": 10,
    "random_seed": 42,
    "gpu": 0,
    "hash_id": "ee805eee"
}
2025-03-15 02:58:54,174 P272409 INFO Load from ../data/processed/HDFS/hdfs_0.0_tar
2025-03-15 02:58:54,175 P272409 INFO {
    "label_file": "../data/HDFS/Full/anomaly_label.csv",
    "log_file": "../data/HDFS/Full/HDFS_log_structured.csv",
    "random_sessions": true,
    "test_ratio": 0.2,
    "train_anomaly_ratio": 0.0
}
2025-03-15 02:58:54,175 P272409 INFO # train sessions 446660 (0.00 anomalies)
2025-03-15 02:58:54,175 P272409 INFO # test sessions 115014 (0.03 anomalies)
2025-03-15 02:58:54,176 P272409 INFO Cannot load cached feature extractor.
2025-03-15 02:58:54,623 P272409 INFO 38 tempaltes are found.
2025-03-15 02:58:54,667 P272409 INFO Transforming train data.
2025-03-15 02:59:04,981 P272409 INFO 4693159 sliding windows generated.
2025-03-15 02:59:20,681 P272409 INFO Finish feature extraction (train).
2025-03-15 02:59:20,682 P272409 INFO Transforming test data.
2025-03-15 02:59:20,766 P272409 INFO 17 new templates show while testing.
2025-03-15 02:59:21,999 P272409 INFO 1206356 sliding windows generated.
2025-03-15 02:59:25,498 P272409 INFO Finish feature extraction (test).
2025-03-15 02:59:30,111 P272409 INFO Start training on 4584 batches with cuda:0.
2025-03-15 03:02:34,686 P272409 INFO Epoch 1/100, training loss: 0.18376 [184.58s]
2025-03-15 03:02:34,687 P272409 INFO Evaluating test data.
2025-03-15 03:03:04,645 P272409 INFO Finish inference. [29.96s]
2025-03-15 03:03:26,858 P272409 INFO Calculating acc sum.
2025-03-15 03:03:28,142 P272409 INFO Finish generating store_df.
2025-03-15 03:03:30,047 P272409 INFO {'f1': '0.149', 'rc': '1.000', 'pc': '0.081', 'top1-acc': '0.970'}
2025-03-15 03:03:30,442 P272409 INFO {'f1': '0.238', 'rc': '0.998', 'pc': '0.135', 'top2-acc': '0.970'}
2025-03-15 03:03:30,740 P272409 INFO {'f1': '0.410', 'rc': '0.982', 'pc': '0.259', 'top3-acc': '0.970'}
2025-03-15 03:03:31,143 P272409 INFO {'f1': '0.920', 'rc': '0.953', 'pc': '0.889', 'top4-acc': '0.970'}
2025-03-15 03:03:31,448 P272409 INFO {'f1': '0.872', 'rc': '0.803', 'pc': '0.954', 'top5-acc': '0.970'}
2025-03-15 03:03:31,690 P272409 INFO {'f1': '0.801', 'rc': '0.682', 'pc': '0.972', 'top6-acc': '0.970'}
2025-03-15 03:03:31,791 P272409 INFO {'f1': '0.795', 'rc': '0.666', 'pc': '0.987', 'top7-acc': '0.970'}
2025-03-15 03:03:31,894 P272409 INFO {'f1': '0.760', 'rc': '0.617', 'pc': '0.990', 'top8-acc': '0.970'}
2025-03-15 03:03:31,991 P272409 INFO {'f1': '0.644', 'rc': '0.477', 'pc': '0.990', 'top9-acc': '0.970'}
2025-03-15 03:03:32,092 P272409 INFO {'f1': '0.605', 'rc': '0.435', 'pc': '0.992', 'top10-acc': '0.970'}
2025-03-15 03:03:32,093 P272409 INFO Finish counting [26.03s]
2025-03-15 03:03:32,708 P272409 INFO Saving model to ./experiment_records/ee805eee/model.ckpt
2025-03-15 03:06:13,745 P272409 INFO Epoch 2/100, training loss: 0.17352 [161.00s]
2025-03-15 03:06:13,745 P272409 INFO Evaluating test data.
2025-03-15 03:07:38,049 P272409 INFO Finish inference. [84.30s]
2025-03-15 03:08:09,661 P272409 INFO Calculating acc sum.
2025-03-15 03:08:10,744 P272409 INFO Finish generating store_df.
2025-03-15 03:08:12,240 P272409 INFO {'f1': '0.165', 'rc': '1.000', 'pc': '0.090', 'top1-acc': '0.970'}
2025-03-15 03:08:12,633 P272409 INFO {'f1': '0.236', 'rc': '0.982', 'pc': '0.134', 'top2-acc': '0.970'}
2025-03-15 03:08:13,054 P272409 INFO {'f1': '0.394', 'rc': '0.957', 'pc': '0.248', 'top3-acc': '0.970'}
2025-03-15 03:08:13,365 P272409 INFO {'f1': '0.902', 'rc': '0.916', 'pc': '0.889', 'top4-acc': '0.970'}
2025-03-15 03:08:13,871 P272409 INFO {'f1': '0.903', 'rc': '0.852', 'pc': '0.960', 'top5-acc': '0.970'}
2025-03-15 03:08:14,249 P272409 INFO {'f1': '0.828', 'rc': '0.718', 'pc': '0.978', 'top6-acc': '0.970'}
2025-03-15 03:08:14,567 P272409 INFO {'f1': '0.750', 'rc': '0.605', 'pc': '0.986', 'top7-acc': '0.970'}
2025-03-15 03:08:14,951 P272409 INFO {'f1': '0.700', 'rc': '0.541', 'pc': '0.990', 'top8-acc': '0.970'}
2025-03-15 03:08:15,328 P272409 INFO {'f1': '0.666', 'rc': '0.501', 'pc': '0.993', 'top9-acc': '0.970'}
2025-03-15 03:08:15,654 P272409 INFO {'f1': '0.644', 'rc': '0.476', 'pc': '0.995', 'top10-acc': '0.970'}
2025-03-15 03:08:15,654 P272409 INFO Finish counting [26.33s]
2025-03-15 03:11:25,412 P272409 INFO Epoch 3/100, training loss: 0.17252 [187.27s]
2025-03-15 03:11:25,412 P272409 INFO Evaluating test data.
2025-03-15 03:12:18,768 P272409 INFO Finish inference. [53.36s]
2025-03-15 03:12:30,451 P272409 INFO Calculating acc sum.
2025-03-15 03:12:31,653 P272409 INFO Finish generating store_df.
2025-03-15 03:12:33,339 P272409 INFO {'f1': '0.165', 'rc': '1.000', 'pc': '0.090', 'top1-acc': '0.970'}
2025-03-15 03:12:33,655 P272409 INFO {'f1': '0.244', 'rc': '0.997', 'pc': '0.139', 'top2-acc': '0.970'}
2025-03-15 03:12:34,052 P272409 INFO {'f1': '0.400', 'rc': '0.979', 'pc': '0.251', 'top3-acc': '0.970'}
2025-03-15 03:12:34,440 P272409 INFO {'f1': '0.922', 'rc': '0.952', 'pc': '0.893', 'top4-acc': '0.970'}
2025-03-15 03:12:34,825 P272409 INFO {'f1': '0.813', 'rc': '0.709', 'pc': '0.953', 'top5-acc': '0.970'}
2025-03-15 03:12:35,157 P272409 INFO {'f1': '0.785', 'rc': '0.656', 'pc': '0.977', 'top6-acc': '0.970'}
2025-03-15 03:12:35,639 P272409 INFO {'f1': '0.752', 'rc': '0.607', 'pc': '0.988', 'top7-acc': '0.970'}
2025-03-15 03:12:35,942 P272409 INFO {'f1': '0.718', 'rc': '0.563', 'pc': '0.991', 'top8-acc': '0.970'}
2025-03-15 03:12:36,346 P272409 INFO {'f1': '0.691', 'rc': '0.530', 'pc': '0.993', 'top9-acc': '0.970'}
2025-03-15 03:12:36,656 P272409 INFO {'f1': '0.608', 'rc': '0.437', 'pc': '0.996', 'top10-acc': '0.970'}
2025-03-15 03:12:36,656 P272409 INFO Finish counting [13.76s]
2025-03-15 03:12:39,240 P272409 INFO Saving model to ./experiment_records/ee805eee/model.ckpt
2025-03-15 03:15:42,868 P272409 INFO Epoch 4/100, training loss: 0.17221 [183.54s]
2025-03-15 03:15:42,869 P272409 INFO Evaluating test data.
2025-03-15 03:16:21,842 P272409 INFO Finish inference. [38.97s]
2025-03-15 03:16:47,047 P272409 INFO Calculating acc sum.
2025-03-15 03:16:48,049 P272409 INFO Finish generating store_df.
2025-03-15 03:16:49,757 P272409 INFO {'f1': '0.166', 'rc': '1.000', 'pc': '0.090', 'top1-acc': '0.970'}
2025-03-15 03:16:50,157 P272409 INFO {'f1': '0.241', 'rc': '0.999', 'pc': '0.137', 'top2-acc': '0.970'}
2025-03-15 03:16:50,645 P272409 INFO {'f1': '0.408', 'rc': '0.989', 'pc': '0.257', 'top3-acc': '0.970'}
2025-03-15 03:16:51,052 P272409 INFO {'f1': '0.929', 'rc': '0.972', 'pc': '0.889', 'top4-acc': '0.970'}
2025-03-15 03:16:51,449 P272409 INFO {'f1': '0.954', 'rc': '0.947', 'pc': '0.961', 'top5-acc': '0.970'}
2025-03-15 03:16:51,953 P272409 INFO {'f1': '0.815', 'rc': '0.699', 'pc': '0.977', 'top6-acc': '0.970'}
2025-03-15 03:16:52,448 P272409 INFO {'f1': '0.771', 'rc': '0.633', 'pc': '0.986', 'top7-acc': '0.970'}
2025-03-15 03:16:52,831 P272409 INFO {'f1': '0.746', 'rc': '0.598', 'pc': '0.990', 'top8-acc': '0.970'}
2025-03-15 03:16:53,226 P272409 INFO {'f1': '0.734', 'rc': '0.582', 'pc': '0.993', 'top9-acc': '0.970'}
2025-03-15 03:16:53,650 P272409 INFO {'f1': '0.693', 'rc': '0.532', 'pc': '0.993', 'top10-acc': '0.970'}
2025-03-15 03:16:53,650 P272409 INFO Finish counting [25.40s]
2025-03-15 03:16:58,636 P272409 INFO Saving model to ./experiment_records/ee805eee/model.ckpt
2025-03-15 03:19:56,562 P272409 INFO Epoch 5/100, training loss: 0.17222 [177.70s]
2025-03-15 03:19:56,564 P272409 INFO Evaluating test data.
2025-03-15 03:20:44,654 P272409 INFO Finish inference. [48.09s]
2025-03-15 03:20:55,795 P272409 INFO Calculating acc sum.
2025-03-15 03:20:56,740 P272409 INFO Finish generating store_df.
2025-03-15 03:20:58,163 P272409 INFO {'f1': '0.164', 'rc': '1.000', 'pc': '0.089', 'top1-acc': '0.970'}
2025-03-15 03:20:58,544 P272409 INFO {'f1': '0.239', 'rc': '0.993', 'pc': '0.136', 'top2-acc': '0.970'}
2025-03-15 03:20:58,942 P272409 INFO {'f1': '0.405', 'rc': '0.964', 'pc': '0.257', 'top3-acc': '0.970'}
2025-03-15 03:20:59,258 P272409 INFO {'f1': '0.915', 'rc': '0.938', 'pc': '0.892', 'top4-acc': '0.970'}
2025-03-15 03:20:59,566 P272409 INFO {'f1': '0.892', 'rc': '0.834', 'pc': '0.959', 'top5-acc': '0.970'}
2025-03-15 03:20:59,950 P272409 INFO {'f1': '0.746', 'rc': '0.604', 'pc': '0.975', 'top6-acc': '0.970'}
2025-03-15 03:21:00,352 P272409 INFO {'f1': '0.708', 'rc': '0.551', 'pc': '0.990', 'top7-acc': '0.970'}
2025-03-15 03:21:00,748 P272409 INFO {'f1': '0.613', 'rc': '0.444', 'pc': '0.992', 'top8-acc': '0.970'}
2025-03-15 03:21:01,065 P272409 INFO {'f1': '0.595', 'rc': '0.425', 'pc': '0.995', 'top9-acc': '0.970'}
2025-03-15 03:21:01,461 P272409 INFO {'f1': '0.577', 'rc': '0.406', 'pc': '0.998', 'top10-acc': '0.970'}
2025-03-15 03:21:01,461 P272409 INFO Finish counting [13.02s]
2025-03-15 03:23:08,421 P272409 INFO Epoch 6/100, training loss: 0.17232 [124.67s]
2025-03-15 03:23:08,422 P272409 INFO Evaluating test data.
2025-03-15 03:23:35,374 P272409 INFO Finish inference. [26.95s]
2025-03-15 03:23:43,050 P272409 INFO Calculating acc sum.
2025-03-15 03:23:43,395 P272409 INFO Finish generating store_df.
2025-03-15 03:23:43,896 P272409 INFO {'f1': '0.150', 'rc': '1.000', 'pc': '0.081', 'top1-acc': '0.970'}
2025-03-15 03:23:44,012 P272409 INFO {'f1': '0.241', 'rc': '0.993', 'pc': '0.137', 'top2-acc': '0.970'}
2025-03-15 03:23:44,121 P272409 INFO {'f1': '0.378', 'rc': '0.898', 'pc': '0.240', 'top3-acc': '0.970'}
2025-03-15 03:23:44,249 P272409 INFO {'f1': '0.874', 'rc': '0.866', 'pc': '0.883', 'top4-acc': '0.970'}
2025-03-15 03:23:44,357 P272409 INFO {'f1': '0.845', 'rc': '0.758', 'pc': '0.955', 'top5-acc': '0.970'}
2025-03-15 03:23:44,459 P272409 INFO {'f1': '0.757', 'rc': '0.619', 'pc': '0.975', 'top6-acc': '0.970'}
2025-03-15 03:23:44,572 P272409 INFO {'f1': '0.728', 'rc': '0.577', 'pc': '0.988', 'top7-acc': '0.970'}
2025-03-15 03:23:44,683 P272409 INFO {'f1': '0.720', 'rc': '0.566', 'pc': '0.991', 'top8-acc': '0.970'}
2025-03-15 03:23:44,785 P272409 INFO {'f1': '0.632', 'rc': '0.464', 'pc': '0.992', 'top9-acc': '0.970'}
2025-03-15 03:23:44,886 P272409 INFO {'f1': '0.585', 'rc': '0.414', 'pc': '0.997', 'top10-acc': '0.970'}
2025-03-15 03:23:44,886 P272409 INFO Finish counting [8.08s]
2025-03-15 03:25:55,454 P272409 INFO Epoch 7/100, training loss: 0.17188 [129.77s]
2025-03-15 03:25:55,455 P272409 INFO Evaluating test data.
2025-03-15 03:26:43,828 P272409 INFO Finish inference. [48.37s]
2025-03-15 03:26:54,618 P272409 INFO Calculating acc sum.
2025-03-15 03:26:55,110 P272409 INFO Finish generating store_df.
2025-03-15 03:26:55,603 P272409 INFO {'f1': '0.165', 'rc': '1.000', 'pc': '0.090', 'top1-acc': '0.970'}
2025-03-15 03:26:55,732 P272409 INFO {'f1': '0.234', 'rc': '0.991', 'pc': '0.132', 'top2-acc': '0.970'}
2025-03-15 03:26:55,853 P272409 INFO {'f1': '0.368', 'rc': '0.974', 'pc': '0.227', 'top3-acc': '0.970'}
2025-03-15 03:26:55,965 P272409 INFO {'f1': '0.915', 'rc': '0.937', 'pc': '0.894', 'top4-acc': '0.970'}
2025-03-15 03:26:56,075 P272409 INFO {'f1': '0.884', 'rc': '0.819', 'pc': '0.962', 'top5-acc': '0.970'}
2025-03-15 03:26:56,185 P272409 INFO {'f1': '0.831', 'rc': '0.723', 'pc': '0.978', 'top6-acc': '0.970'}
2025-03-15 03:26:56,298 P272409 INFO {'f1': '0.766', 'rc': '0.625', 'pc': '0.991', 'top7-acc': '0.970'}
2025-03-15 03:26:56,414 P272409 INFO {'f1': '0.702', 'rc': '0.543', 'pc': '0.993', 'top8-acc': '0.970'}
2025-03-15 03:26:56,525 P272409 INFO {'f1': '0.683', 'rc': '0.520', 'pc': '0.994', 'top9-acc': '0.970'}
2025-03-15 03:26:56,641 P272409 INFO {'f1': '0.673', 'rc': '0.509', 'pc': '0.994', 'top10-acc': '0.970'}
2025-03-15 03:26:56,641 P272409 INFO Finish counting [8.14s]
2025-03-15 03:26:57,399 P272409 INFO Early stop at epoch: 7
2025-03-15 03:26:57,399 P272409 INFO Loading model from ./experiment_records/ee805eee/model.ckpt
